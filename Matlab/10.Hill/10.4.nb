(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     13060,        374]
NotebookOptionsPosition[     12530,        352]
NotebookOutlinePosition[     12883,        368]
CellTagsIndexPosition[     12840,        365]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"text", "=", "\"\<VIKYNOTCLKYRJQETIRECVUZLNOJTUYDIMHRCFITQ\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ToCharacterCode", "@", "#"}], ")"}], "-", "64"}], ")"}], "~",
      "Mod", "~", "26"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{
    RowBox[{"FromCharacterCode", "@", 
     RowBox[{"(", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#", "\[Equal]", "0"}], ",", 
        RowBox[{"26", "+", "64", "+", "32"}], ",", 
        RowBox[{"#", "+", "64", "+", "32"}]}], "]"}], ")"}]}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Ps", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "@", 
     RowBox[{"{", "#", "}"}]}], "&"}], "/@", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"f", "@", "text"}], ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<K\>\"", ",", "\"\<E\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<L\>\"", ",", "\"\<K\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"b", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Flatten", "/@", 
      RowBox[{"ToCharacterCode", "/@", "a"}]}], "-", "64"}], ")"}], "~", 
   "Mod", "~", "26"}]}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "x1"}], "+", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "x2"}]}], "\[Equal]", 
       RowBox[{"b", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "x3"}], "+", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", "x4"}]}], "\[Equal]", 
       RowBox[{"b", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], ",", 
    RowBox[{"Modulus", "\[Rule]", "26"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1", ",", "x2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x3", ",", "x4"}], "}"}]}], "}"}], "/.", "sol"}], "/.", 
         "#"}], ")"}]}], "~", "Mod", "~", "26"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"C", "[", "1", "]"}], "\[Rule]", "i"}], ",", 
          RowBox[{
           RowBox[{"C", "[", "2", "]"}], "\[Rule]", "j"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "25"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "25"}], "}"}]}], "]"}], "~", "Flatten", 
      "~", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "Bs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bs", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"Bs", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Divisors", "@", 
           RowBox[{"Det", "@", "#"}]}], "~", "Intersection", "~", 
          RowBox[{"{", 
           RowBox[{"2", ",", "13"}], "}"}]}], ")"}]}], "\[Equal]", "0"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "Bs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"B", ".", "P"}], ")"}], "~", "Mod", "~", "26"}], ",", 
     RowBox[{"{", 
      RowBox[{"B", ",", "Bs"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"P", ",", "Ps"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "@", "Qs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StringJoin", "@", 
     RowBox[{"(", 
      RowBox[{"g", "/@", 
       RowBox[{"(", 
        RowBox[{"#", "~", "Flatten", "~", "2"}], ")"}]}], ")"}]}], "&"}], "/@",
    "Qs"}], ";", "\[AliasDelimiter]"}]}], "Input",
 CellChangeTimes->{{3.641540212076167*^9, 3.6415402600938053`*^9}, {
   3.641607118339303*^9, 3.641607118964367*^9}, {3.641607162989103*^9, 
   3.6416072927507305`*^9}, {3.641607352105116*^9, 3.6416074783782253`*^9}, {
   3.6416075225567493`*^9, 3.641607529417446*^9}, {3.641607559837228*^9, 
   3.6416076527942877`*^9}, {3.641607693856449*^9, 3.6416077618706045`*^9}, {
   3.6416078178040667`*^9, 3.641607919799817*^9}, {3.6416080202629013`*^9, 
   3.641608114623687*^9}, {3.64160817689411*^9, 3.64160831258031*^9}, {
   3.6416083527952456`*^9, 3.641608573606242*^9}, {3.6416087266759415`*^9, 
   3.6416087297385626`*^9}, 3.6416091797513356`*^9, 3.6416096849504604`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "22", "}"}], ",", 
     RowBox[{"{", "9", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "11", "}"}], ",", 
     RowBox[{"{", "25", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "14", "}"}], ",", 
     RowBox[{"{", "15", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "20", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "12", "}"}], ",", 
     RowBox[{"{", "11", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "25", "}"}], ",", 
     RowBox[{"{", "18", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "10", "}"}], ",", 
     RowBox[{"{", "17", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "20", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "9", "}"}], ",", 
     RowBox[{"{", "18", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "22", "}"}], ",", 
     RowBox[{"{", "21", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "12", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "14", "}"}], ",", 
     RowBox[{"{", "15", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "10", "}"}], ",", 
     RowBox[{"{", "20", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "21", "}"}], ",", 
     RowBox[{"{", "25", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "9", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "13", "}"}], ",", 
     RowBox[{"{", "8", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "18", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "6", "}"}], ",", 
     RowBox[{"{", "9", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "20", "}"}], ",", 
     RowBox[{"{", "17", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.641607395379837*^9, {3.6416074671309175`*^9, 3.6416074788626204`*^9}, 
   3.641607529823704*^9, {3.641607568838621*^9, 3.641607653278674*^9}, {
   3.641607882953543*^9, 3.6416079202842107`*^9}, {3.6416080211066957`*^9, 
   3.6416080257389574`*^9}, 3.6416080566036825`*^9, 3.641608117998823*^9, 
   3.6416081982720947`*^9, {3.6416082557160416`*^9, 3.6416083129553123`*^9}, {
   3.6416083560453606`*^9, 3.641608407536256*^9}, {3.6416084865367513`*^9, 
   3.6416085784814367`*^9}, 3.6416087303166957`*^9, 3.641609181533679*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"11", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "11"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.641607395379837*^9, {3.6416074671309175`*^9, 3.6416074788626204`*^9}, 
   3.641607529823704*^9, {3.641607568838621*^9, 3.641607653278674*^9}, {
   3.641607882953543*^9, 3.6416079202842107`*^9}, {3.6416080211066957`*^9, 
   3.6416080257389574`*^9}, 3.6416080566036825`*^9, 3.641608117998823*^9, 
   3.6416081982720947`*^9, {3.6416082557160416`*^9, 3.6416083129553123`*^9}, {
   3.6416083560453606`*^9, 3.641608407536256*^9}, {3.6416084865367513`*^9, 
   3.6416085784814367`*^9}, 3.6416087303166957`*^9, 3.641609181549305*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x1", "\[Rule]", 
     RowBox[{"C", "[", "1", "]"}]}], ",", 
    RowBox[{"x2", "\[Rule]", 
     RowBox[{"1", "+", 
      RowBox[{"6", " ", 
       RowBox[{"C", "[", "1", "]"}]}]}]}], ",", 
    RowBox[{"x3", "\[Rule]", 
     RowBox[{"C", "[", "2", "]"}]}], ",", 
    RowBox[{"x4", "\[Rule]", 
     RowBox[{"17", "+", 
      RowBox[{"6", " ", 
       RowBox[{"C", "[", "2", "]"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.641607395379837*^9, {3.6416074671309175`*^9, 3.6416074788626204`*^9}, 
   3.641607529823704*^9, {3.641607568838621*^9, 3.641607653278674*^9}, {
   3.641607882953543*^9, 3.6416079202842107`*^9}, {3.6416080211066957`*^9, 
   3.6416080257389574`*^9}, 3.6416080566036825`*^9, 3.641608117998823*^9, 
   3.6416081982720947`*^9, {3.6416082557160416`*^9, 3.6416083129553123`*^9}, {
   3.6416083560453606`*^9, 3.641608407536256*^9}, {3.6416084865367513`*^9, 
   3.6416085784814367`*^9}, 3.6416087303166957`*^9, 3.641609181549305*^9}],

Cell[BoxData["676"], "Output",
 CellChangeTimes->{
  3.641607395379837*^9, {3.6416074671309175`*^9, 3.6416074788626204`*^9}, 
   3.641607529823704*^9, {3.641607568838621*^9, 3.641607653278674*^9}, {
   3.641607882953543*^9, 3.6416079202842107`*^9}, {3.6416080211066957`*^9, 
   3.6416080257389574`*^9}, 3.6416080566036825`*^9, 3.641608117998823*^9, 
   3.6416081982720947`*^9, {3.6416082557160416`*^9, 3.6416083129553123`*^9}, {
   3.6416083560453606`*^9, 3.641608407536256*^9}, {3.6416084865367513`*^9, 
   3.6416085784814367`*^9}, 3.6416087303166957`*^9, 3.6416091816118135`*^9}],

Cell[BoxData["312"], "Output",
 CellChangeTimes->{
  3.641607395379837*^9, {3.6416074671309175`*^9, 3.6416074788626204`*^9}, 
   3.641607529823704*^9, {3.641607568838621*^9, 3.641607653278674*^9}, {
   3.641607882953543*^9, 3.6416079202842107`*^9}, {3.6416080211066957`*^9, 
   3.6416080257389574`*^9}, 3.6416080566036825`*^9, 3.641608117998823*^9, 
   3.6416081982720947`*^9, {3.6416082557160416`*^9, 3.6416083129553123`*^9}, {
   3.6416083560453606`*^9, 3.641608407536256*^9}, {3.6416084865367513`*^9, 
   3.6416085784814367`*^9}, 3.6416087303166957`*^9, 3.641609181980233*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"312", ",", "20", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.641607395379837*^9, {3.6416074671309175`*^9, 3.6416074788626204`*^9}, 
   3.641607529823704*^9, {3.641607568838621*^9, 3.641607653278674*^9}, {
   3.641607882953543*^9, 3.6416079202842107`*^9}, {3.6416080211066957`*^9, 
   3.6416080257389574`*^9}, 3.6416080566036825`*^9, 3.641608117998823*^9, 
   3.6416081982720947`*^9, {3.6416082557160416`*^9, 3.6416083129553123`*^9}, {
   3.6416083560453606`*^9, 3.641608407536256*^9}, {3.6416084865367513`*^9, 
   3.6416085784814367`*^9}, 3.6416087303166957`*^9, 3.6416091820896125`*^9}]
}, Open  ]]
},
WindowSize->{634, 729},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (2013\:5e742\:670813\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 5509, 162, 392, "Input"],
Cell[6091, 186, 2849, 90, 112, "Output"],
Cell[8943, 278, 723, 14, 31, "Output"],
Cell[9669, 294, 1029, 23, 31, "Output"],
Cell[10701, 319, 581, 8, 31, "Output"],
Cell[11285, 329, 579, 8, 31, "Output"],
Cell[11867, 339, 647, 10, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
